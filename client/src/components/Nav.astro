---
interface Props {
  variant?: 'list' | 'single';
}

const { variant = 'list' } = Astro.props;
---

<nav class={variant === 'single' ? 'nav-single' : 'nav-list'}>
  <slot />
</nav>

<style>
  nav {
    position: sticky;
    top: 0;
    backdrop-filter: blur(4px);
    z-index: 100;
    transition: all 0.3s ease;
  }

  nav.stuck,
  .nav-single {
    align-items: center;
    background-color: var(--color-primary-transparent);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    color: var(--text-inverse);
    padding: 0.75rem 1rem;
  }

  nav.stuck :global(a),
  nav.stuck :global(button),
  nav.stuck :global(a:hover),
  .nav-single :global(a) {
    color: var(--text-inverse);
  }

  nav.stuck :global(a:hover) {
    text-decoration: underline;
  }

  .nav-list :global(ul),
  .nav-list :global(li),
  .nav-single {
    align-items: center;
    display: flex;
    flex-direction: row;
    justify-content: center;
  }

  .nav-single {
    justify-content: flex-start;
  }

  .nav-list :global(li:not(:last-child)::after) {
    content: '|';
    font-size: 1.5rem;
    margin: 0 4px 1px;
  }

  .nav-single::after {
    content: '\00A0';
    font-size: 1.5rem;
    margin: 0 0 1px;
  }
</style>

<script>
  import { tooltipManager } from '../utils/tooltip.ts';

  document.addEventListener('DOMContentLoaded', function () {
    const emailButton = document.getElementById('email-button');
    const nav = document.querySelector('nav');

    // Handle email button click
    if (emailButton) {
      emailButton.addEventListener('click', function () {
        const email = 'bailee.dast@gmail.com';
        navigator.clipboard
          .writeText(email)
          .then(() => {
            tooltipManager.show(emailButton, {
              text: 'Copied!',
              position: 'bottom',
              color: '#fff',
              backgroundColor: 'var(--color-success)',
              duration: 1500,
            });
          })
          .catch((err) => {
            console.error('Failed to copy email: ', err);
            // Fallback: show email in alert
            alert(email);
          });
      });
    }

    // Handle nav stuck state - only for list variant
    if (nav && nav.classList.contains('nav-list')) {
      let isStuck = false;

      window.addEventListener('scroll', () => {
        const navRect = nav.getBoundingClientRect();
        const shouldBeStuck = navRect.top <= 0;

        if (shouldBeStuck && !isStuck) {
          nav.classList.add('stuck');
          isStuck = true;
        } else if (!shouldBeStuck && isStuck) {
          nav.classList.remove('stuck');
          isStuck = false;
        }
      });
    }
  });
</script>
